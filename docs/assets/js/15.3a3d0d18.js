(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{260:function(s,e,t){"use strict";t.r(e);var n=t(28),r=Object(n.a)({},(function(){var s=this,e=s.$createElement,t=s._self._c||e;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h3",{attrs:{id:"自定义插件"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#自定义插件"}},[s._v("#")]),s._v(" 自定义插件")]),s._v(" "),t("h4",{attrs:{id:"步骤"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#步骤"}},[s._v("#")]),s._v(" 步骤")]),s._v(" "),t("p",[s._v("推荐您直接基于turms-plugin-demo进行开发，以减少不必要的操作。")]),s._v(" "),t("ol",[t("li",[s._v("新建一个Maven项目")]),s._v(" "),t("li",[s._v("在pom.xml中引入：")])]),s._v(" "),t("p",[t("s",[s._v("添加仓库：")])]),s._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("<repository>\n    <id>sonatype-nexus-snapshots</id>\n    <name>Sonatype Nexus Snapshots</name>\n    <url>https://oss.sonatype.org/content/repositories/snapshots/</url>\n</repository>\n")])])]),t("p",[s._v("Clone Turms的仓库，并在Turms服务端项目的目录下，通过mvn install命令将其安装到本地的Maven仓库中")]),s._v(" "),t("p",[s._v("添加依赖：")]),s._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("<dependency>\n    <groupId>im.turms</groupId>\n    <artifactId>turms</artifactId>\n    <version>0.9.0-SNAPSHOT</version>\n</dependency>\n")])])]),t("ol",{attrs:{start:"3"}},[t("li",[s._v("新建一个extends自TurmsPlugin的类（例如：public class MyPlugin extends TurmsPlugin）")]),s._v(" "),t("li",[s._v("在这个新建类的内部，定义一个您想要实现的接口插件静态实现类（例如：public static class MyTurmsRequestHandler implements ClientRequestHandler），并在该注释上@Extension")]),s._v(" "),t("li",[s._v("将resources目录下的plugin.properties文件修改为您自己的插件说明")]),s._v(" "),t("li",[s._v("用Maven打包项目，并将打包好的jar包放入turms的plugins目录下")]),s._v(" "),t("li",[s._v("启动Turms服务端，Turms将自动加载plugins目录下的所有插件")])]),s._v(" "),t("p",[s._v("目前支持的插件：")]),s._v(" "),t("p",[s._v("①ClientRequestHandler：客户端请求处理器。它可以拦截客户端发出的所有TurmsRequest请求，您可以通过它：1. transform：转换TurmsRequest中的参数，甚至转换成其他类型的请求；2. 自定义处理实现，等同于直接修改Turms的源代码。例如，您可以将任何请求转发给任何用户（仍需要关系认证）。")]),s._v(" "),t("p",[s._v("②UserAuthenticator：用户登陆认证。Turms会解析用户发来的握手请求，并解析成UserLoginInfo对象，供您判断是否允许用户进行登陆。")]),s._v(" "),t("p",[s._v("③ExpiryMessageAutoDeletionNotificationHandler： 过期消息自动删除通知处理器。当Turms自动定期删除过期消息时，Turms服务端会调用该接口，告知该插件实现方所有将要被删除的消息（完整的im.turms.turms.pojo.domain.Message对象）。常用于开发者异地备份消息。")]),s._v(" "),t("p",[s._v("④UserOnlineStatusChangeHandler： 用户在线状态变更处理器。当任意一位用户进入上线或离线状态时，Turms会调用该接口")])])}),[],!1,null,null,null);e.default=r.exports}}]);